; run menhir test

(alias
 (name olly)
 (deps ../bin/olly.exe))

(rule
 (alias runtest)
 (deps
  (alias olly)
  ocaml.mly)
 (action
  (run olly gc-stats "menhir ocaml.mly")))

(rule
 (alias trace)
 (enabled_if
  (>= %{ocaml_version} 5.1.0))
 (target test.trace)
 (deps
  (alias olly)
  test.exe)
 (action
  (progn
   (run olly trace test.trace ./test.exe))))

(executable
 (name test)
 (enabled_if
  (>= %{ocaml_version} 5.1.0))
 (libraries runtime_events unix))
